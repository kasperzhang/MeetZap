{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { mapState } from \"vuex\";\nimport { isPhone, post, generateEnabledCalendarsPayload } from \"@/utils\";\nimport CalendarAccounts from \"@/components/settings/CalendarAccounts.vue\";\nimport CalendarPermissionsCard from \"@/components/calendar_permission_dialogs/CalendarPermissionsCard.vue\";\nimport UserChip from \"@/components/general/UserChip.vue\";\nexport default {\n  name: \"InvitationDialog\",\n  emits: [\"input\"],\n  props: {\n    value: {\n      type: Boolean,\n      required: true\n    },\n    group: {\n      type: Object\n    },\n    calendarPermissionGranted: {\n      type: Boolean,\n      required: true\n    }\n  },\n  components: {\n    CalendarAccounts,\n    UserChip,\n    CalendarPermissionsCard\n  },\n  data: () => ({\n    calendarAccounts: {},\n    rejectDialog: false\n  }),\n  mounted() {\n    this.calendarAccounts = JSON.parse(JSON.stringify(this.authUser.calendarAccounts));\n  },\n  computed: {\n    ...mapState([\"authUser\"]),\n    isPhone() {\n      return isPhone(this.$vuetify);\n    },\n    isOwner() {\n      return this.authUser._id === this.group.ownerId;\n    },\n    membersToShareWith() {\n      return this.group.attendees?.filter(u => !u.declined && u.email != this.authUser.email);\n    }\n  },\n  methods: {\n    goHome() {\n      this.$router.push({\n        name: \"home\"\n      });\n    },\n    rejectInvitation() {\n      post(`/events/${this.group._id}/decline`).then(res => {\n        this.$router.replace({\n          name: \"home\"\n        });\n      });\n    },\n    acceptInvitation() {\n      const payload = generateEnabledCalendarsPayload(this.calendarAccounts);\n      post(`/events/${this.group._id}/response`, payload).then(res => {\n        this.$emit(\"input\", false);\n        this.$emit(\"refreshEvent\");\n      });\n    },\n    toggleCalendarAccount(payload) {\n      this.calendarAccounts[`${payload.email}_${payload.calendarType}`].enabled = payload.enabled;\n    },\n    toggleSubCalendarAccount(payload) {\n      this.calendarAccounts[`${payload.email}_${payload.calendarType}`].subCalendars[payload.subCalendarId].enabled = payload.enabled;\n    }\n  }\n};","map":{"version":3,"names":["mapState","isPhone","post","generateEnabledCalendarsPayload","CalendarAccounts","CalendarPermissionsCard","UserChip","name","emits","props","value","type","Boolean","required","group","Object","calendarPermissionGranted","components","data","calendarAccounts","rejectDialog","mounted","JSON","parse","stringify","authUser","computed","$vuetify","isOwner","_id","ownerId","membersToShareWith","attendees","filter","u","declined","email","methods","goHome","$router","push","rejectInvitation","then","res","replace","acceptInvitation","payload","$emit","toggleCalendarAccount","calendarType","enabled","toggleSubCalendarAccount","subCalendars","subCalendarId"],"sources":["src/components/groups/InvitationDialog.vue"],"sourcesContent":["<template>\n  <v-dialog\n    :value=\"value\"\n    @input=\"(e) => $emit('input', e)\"\n    content-class=\"tw-max-w-[35rem] tw-m-0 tw-max-h-full\"\n    :transition=\"isPhone ? `dialog-bottom-transition` : `dialog-transition`\"\n    persistent\n  >\n    <v-expand-transition>\n      <v-card\n        class=\"tw-overflow-none tw-relative tw-flex tw-flex-col tw-rounded-lg tw-px-2 tw-py-5 tw-transition-all\"\n      >\n        <v-card-text>\n          <div\n            class=\"tw-mb-5 tw-text-wrap tw-text-xl tw-font-medium tw-text-black\"\n          >\n            <template v-if=\"isOwner\"> Share calendar availability </template>\n            <template v-else>\n              Accept invitation to share your calendar availability with \"{{\n                group.name\n              }}\"?\n            </template>\n          </div>\n          <v-expand-transition>\n            <div v-if=\"calendarPermissionGranted\">\n              <CalendarAccounts\n                :sync-with-backend=\"false\"\n                :allow-add-calendar-account=\"false\"\n                :toggle-state=\"true\"\n                :fill-space=\"true\"\n                @toggleCalendarAccount=\"toggleCalendarAccount\"\n                @toggleSubCalendarAccount=\"toggleSubCalendarAccount\"\n              ></CalendarAccounts>\n\n              <div class=\"tw-mt-5 tw-space-y-4\">\n                <div class=\"tw-font-medium tw-text-black\">\n                  Your calendar availability from these calendars will be shared\n                  with:\n                </div>\n                <div\n                  class=\"tw-flex tw-flex-wrap tw-gap-1\"\n                  v-if=\"membersToShareWith.length > 0\"\n                >\n                  <UserChip\n                    v-for=\"user in membersToShareWith\"\n                    :key=\"user.email\"\n                    :user=\"user\"\n                  ></UserChip>\n                </div>\n                <div v-else class=\"tw-flex tw-items-center tw-italic\">\n                  <div>No members added yet</div>\n                </div>\n                <div class=\"tw-text-xs tw-text-dark-gray\">\n                  Your calendar events will NOT be visible to others\n                </div>\n              </div>\n            </div>\n          </v-expand-transition>\n\n          <v-expand-transition>\n            <div class=\"tw-p-5 tw-text-black\" v-if=\"!calendarPermissionGranted\">\n              <CalendarPermissionsCard\n                v-show=\"true\"\n                cancelLabel=\"\"\n                @allow=\"\n                  () => {\n                    $emit('setAvailabilityAutomatically')\n                  }\n                \"\n              />\n            </div>\n          </v-expand-transition>\n        </v-card-text>\n\n        <v-card-actions v-if=\"isOwner\">\n          <v-btn class=\"tw-px-6\" @click=\"goHome\" text>Back</v-btn>\n          <v-spacer />\n          <v-btn\n            color=\"primary\"\n            @click=\"acceptInvitation\"\n            :disabled=\"!calendarPermissionGranted\"\n            class=\"tw-px-6\"\n            >Share</v-btn\n          >\n        </v-card-actions>\n        <v-card-actions v-else>\n          <v-dialog v-model=\"rejectDialog\" width=\"400\" persistent>\n            <template v-slot:activator=\"{ on, attrs }\">\n              <v-btn text class=\"tw-text-dark-gray\" v-bind=\"attrs\" v-on=\"on\"\n                >Reject invitation</v-btn\n              >\n            </template>\n            <v-card>\n              <v-card-title>Are you sure?</v-card-title>\n              <v-card-text\n                >Are you sure you want to reject this invite?</v-card-text\n              >\n              <v-card-actions>\n                <v-spacer />\n                <v-btn\n                  text\n                  class=\"tw-text-dark-gray\"\n                  @click=\"rejectDialog = false\"\n                  >Cancel</v-btn\n                >\n                <v-btn text @click=\"rejectInvitation\" color=\"error\"\n                  >I'm sure</v-btn\n                >\n              </v-card-actions>\n            </v-card>\n          </v-dialog>\n          <v-spacer />\n          <v-btn\n            class=\"tw-bg-green tw-px-5 tw-text-white tw-transition-opacity\"\n            @click=\"acceptInvitation\"\n            :disabled=\"!calendarPermissionGranted\"\n            >Accept Invitation</v-btn\n          >\n        </v-card-actions>\n      </v-card>\n    </v-expand-transition>\n  </v-dialog>\n</template>\n\n<script>\nimport { mapState } from \"vuex\"\nimport { isPhone, post, generateEnabledCalendarsPayload } from \"@/utils\"\nimport CalendarAccounts from \"@/components/settings/CalendarAccounts.vue\"\nimport CalendarPermissionsCard from \"@/components/calendar_permission_dialogs/CalendarPermissionsCard.vue\"\nimport UserChip from \"@/components/general/UserChip.vue\"\n\nexport default {\n  name: \"InvitationDialog\",\n\n  emits: [\"input\"],\n\n  props: {\n    value: { type: Boolean, required: true },\n    group: { type: Object },\n    calendarPermissionGranted: { type: Boolean, required: true },\n  },\n\n  components: {\n    CalendarAccounts,\n    UserChip,\n    CalendarPermissionsCard,\n  },\n\n  data: () => ({\n    calendarAccounts: {},\n    rejectDialog: false,\n  }),\n\n  mounted() {\n    this.calendarAccounts = JSON.parse(\n      JSON.stringify(this.authUser.calendarAccounts)\n    )\n  },\n\n  computed: {\n    ...mapState([\"authUser\"]),\n    isPhone() {\n      return isPhone(this.$vuetify)\n    },\n    isOwner() {\n      return this.authUser._id === this.group.ownerId\n    },\n    membersToShareWith() {\n      return this.group.attendees?.filter(\n        (u) => !u.declined && u.email != this.authUser.email\n      )\n    },\n  },\n  methods: {\n    goHome() {\n      this.$router.push({ name: \"home\" })\n    },\n    rejectInvitation() {\n      post(`/events/${this.group._id}/decline`).then((res) => {\n        this.$router.replace({ name: \"home\" })\n      })\n    },\n\n    acceptInvitation() {\n      const payload = generateEnabledCalendarsPayload(this.calendarAccounts)\n\n      post(`/events/${this.group._id}/response`, payload).then((res) => {\n        this.$emit(\"input\", false)\n        this.$emit(\"refreshEvent\")\n      })\n    },\n\n    toggleCalendarAccount(payload) {\n      this.calendarAccounts[\n        `${payload.email}_${payload.calendarType}`\n      ].enabled = payload.enabled\n    },\n\n    toggleSubCalendarAccount(payload) {\n      this.calendarAccounts[\n        `${payload.email}_${payload.calendarType}`\n      ].subCalendars[payload.subCalendarId].enabled = payload.enabled\n    },\n  },\n}\n</script>\n"],"mappings":";AA6HA,SAAAA,QAAA;AACA,SAAAC,OAAA,EAAAC,IAAA,EAAAC,+BAAA;AACA,OAAAC,gBAAA;AACA,OAAAC,uBAAA;AACA,OAAAC,QAAA;AAEA;EACAC,IAAA;EAEAC,KAAA;EAEAC,KAAA;IACAC,KAAA;MAAAC,IAAA,EAAAC,OAAA;MAAAC,QAAA;IAAA;IACAC,KAAA;MAAAH,IAAA,EAAAI;IAAA;IACAC,yBAAA;MAAAL,IAAA,EAAAC,OAAA;MAAAC,QAAA;IAAA;EACA;EAEAI,UAAA;IACAb,gBAAA;IACAE,QAAA;IACAD;EACA;EAEAa,IAAA,EAAAA,CAAA;IACAC,gBAAA;IACAC,YAAA;EACA;EAEAC,QAAA;IACA,KAAAF,gBAAA,GAAAG,IAAA,CAAAC,KAAA,CACAD,IAAA,CAAAE,SAAA,MAAAC,QAAA,CAAAN,gBAAA,CACA;EACA;EAEAO,QAAA;IACA,GAAA1B,QAAA;IACAC,QAAA;MACA,OAAAA,OAAA,MAAA0B,QAAA;IACA;IACAC,QAAA;MACA,YAAAH,QAAA,CAAAI,GAAA,UAAAf,KAAA,CAAAgB,OAAA;IACA;IACAC,mBAAA;MACA,YAAAjB,KAAA,CAAAkB,SAAA,EAAAC,MAAA,CACAC,CAAA,KAAAA,CAAA,CAAAC,QAAA,IAAAD,CAAA,CAAAE,KAAA,SAAAX,QAAA,CAAAW,KACA;IACA;EACA;EACAC,OAAA;IACAC,OAAA;MACA,KAAAC,OAAA,CAAAC,IAAA;QAAAjC,IAAA;MAAA;IACA;IACAkC,iBAAA;MACAvC,IAAA,iBAAAY,KAAA,CAAAe,GAAA,YAAAa,IAAA,CAAAC,GAAA;QACA,KAAAJ,OAAA,CAAAK,OAAA;UAAArC,IAAA;QAAA;MACA;IACA;IAEAsC,iBAAA;MACA,MAAAC,OAAA,GAAA3C,+BAAA,MAAAgB,gBAAA;MAEAjB,IAAA,iBAAAY,KAAA,CAAAe,GAAA,aAAAiB,OAAA,EAAAJ,IAAA,CAAAC,GAAA;QACA,KAAAI,KAAA;QACA,KAAAA,KAAA;MACA;IACA;IAEAC,sBAAAF,OAAA;MACA,KAAA3B,gBAAA,CACA,GAAA2B,OAAA,CAAAV,KAAA,IAAAU,OAAA,CAAAG,YAAA,GACA,CAAAC,OAAA,GAAAJ,OAAA,CAAAI,OAAA;IACA;IAEAC,yBAAAL,OAAA;MACA,KAAA3B,gBAAA,CACA,GAAA2B,OAAA,CAAAV,KAAA,IAAAU,OAAA,CAAAG,YAAA,GACA,CAAAG,YAAA,CAAAN,OAAA,CAAAO,aAAA,EAAAH,OAAA,GAAAJ,OAAA,CAAAI,OAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}