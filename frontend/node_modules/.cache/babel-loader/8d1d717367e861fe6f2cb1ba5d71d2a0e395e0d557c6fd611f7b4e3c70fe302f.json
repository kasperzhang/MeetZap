{"ast":null,"code":"import { isPhone } from \"@/utils\";\nimport { mapActions, mapState } from \"vuex\";\nimport CalendarPermissionsCard from \"./CalendarPermissionsCard\";\nimport CreateAccount from \"./CreateAccount\";\nimport AppleCredentials from \"./AppleCredentials\";\nexport default {\n  name: \"MarkAvailabilityDialog\",\n  props: {\n    value: {\n      type: Boolean,\n      required: true\n    },\n    initialState: {\n      type: String,\n      default: \"choices\"\n    }\n  },\n  components: {\n    CalendarPermissionsCard,\n    CreateAccount,\n    AppleCredentials\n  },\n  data() {\n    return {\n      states: {\n        CHOICES: \"choices\",\n        // present user with choice of automatic or manual\n        GCAL_PERMISSIONS: \"gcal_permissions\",\n        // present to user the gcal permissions we request\n        CREATE_ACCOUNT_APPLE: \"create_account_apple\",\n        // present to user the create account dialog\n        APPLE_CREDENTIALS: \"apple_credentials\" // present to user the apple credentials dialog\n      },\n      state: this.initialState\n    };\n  },\n  computed: {\n    ...mapState([\"authUser\"]),\n    isPhone() {\n      return isPhone(this.$vuetify);\n    }\n  },\n  methods: {\n    ...mapActions([\"showInfo\"]),\n    setAvailabilityManually() {\n      this.$emit(\"setAvailabilityManually\");\n    },\n    autofillWithGcal() {\n      this.$posthog?.capture(\"autofill_with_gcal_clicked\");\n      this.state = this.states.GCAL_PERMISSIONS;\n    },\n    autofillWithApple() {\n      this.$posthog?.capture(\"autofill_with_apple_clicked\");\n      if (this.authUser) {\n        this.state = this.states.APPLE_CREDENTIALS;\n      } else {\n        this.state = this.states.CREATE_ACCOUNT_APPLE;\n      }\n    },\n    autofillWithOutlook() {\n      this.$posthog?.capture(\"autofill_with_outlook_clicked\");\n      this.$emit(\"allowOutlookCalendar\");\n    },\n    showChoices() {\n      this.state = this.states.CHOICES;\n    }\n  },\n  watch: {\n    value() {\n      if (!this.value) setTimeout(() => this.state = this.states.CHOICES, 100);\n    }\n  }\n};","map":{"version":3,"names":["isPhone","mapActions","mapState","CalendarPermissionsCard","CreateAccount","AppleCredentials","name","props","value","type","Boolean","required","initialState","String","default","components","data","states","CHOICES","GCAL_PERMISSIONS","CREATE_ACCOUNT_APPLE","APPLE_CREDENTIALS","state","computed","$vuetify","methods","setAvailabilityManually","$emit","autofillWithGcal","$posthog","capture","autofillWithApple","authUser","autofillWithOutlook","showChoices","watch","setTimeout"],"sources":["src/components/calendar_permission_dialogs/MarkAvailabilityDialog.vue"],"sourcesContent":["<template>\n  <v-dialog\n    :value=\"value\"\n    @input=\"(e) => $emit('input', e)\"\n    width=\"400\"\n    content-class=\"tw-m-0\"\n  >\n    <v-card class=\"tw-p-4 sm:tw-p-6\">\n      <v-expand-transition>\n        <div v-show=\"state === states.CHOICES\">\n          <div class=\"tw-text-md mb-1 tw-text-center\">\n            您可以手动填写您的空余时间或者从日历中导入 <br class=\"tw-block sm:tw-hidden\" />\n        \n          </div>\n          <div class=\"tw-pb-4 tw-text-center tw-text-xs tw-text-dark-gray\">\n            从日历导入后也可以继续手动修改哦\n          </div>\n          <div class=\"tw-flex tw-flex-col tw-gap-2\">\n            <v-btn block @click=\"autofillWithGcal\" class=\"tw-bg-white\">\n              <div class=\"tw-flex tw-w-full tw-items-center tw-gap-2\">\n                <v-img\n                  class=\"tw-flex-initial\"\n                  width=\"20\"\n                  height=\"20\"\n                  src=\"@/assets/google_logo.svg\"\n                />\n                <v-spacer />\n                导入 Google Calendar\n                <v-spacer />\n              </div>\n            </v-btn>\n            <v-btn block @click=\"autofillWithApple\" class=\"tw-bg-white\">\n              <div class=\"tw-flex tw-w-full tw-items-center tw-gap-2\">\n                <v-img\n                  class=\"tw-flex-initial\"\n                  width=\"20\"\n                  height=\"20\"\n                  src=\"@/assets/apple_logo.svg\"\n                />\n                <v-spacer />\n                导入 Apple Calendar\n                <v-spacer />\n              </div>\n            </v-btn>\n            <v-btn block @click=\"autofillWithOutlook\" class=\"tw-bg-white\">\n              <div class=\"tw-flex tw-w-full tw-items-center tw-gap-2\">\n                <v-img\n                  class=\"tw-flex-initial\"\n                  width=\"20\"\n                  height=\"20\"\n                  src=\"@/assets/outlook_logo.svg\"\n                />\n                <v-spacer />\n                从 Outlook Calendar 导入\n                <v-spacer />\n              </div>\n            </v-btn>\n            <div class=\"tw-flex tw-items-center tw-gap-3\">\n              <v-divider />\n              <div\n                class=\"tw-text-center tw-text-xs tw-font-medium tw-text-dark-gray\"\n              >\n                or\n              </div>\n              <v-divider />\n            </div>\n            <v-btn @click=\"setAvailabilityManually\" block>Manually</v-btn>\n          </div>\n        </div>\n      </v-expand-transition>\n      <v-expand-transition>\n        <CalendarPermissionsCard\n          v-show=\"state === states.GCAL_PERMISSIONS\"\n          cancelLabel=\"Back\"\n          @cancel=\"showChoices\"\n          @allow=\"$emit('allowGoogleCalendar')\"\n        />\n      </v-expand-transition>\n      <v-expand-transition>\n        <CreateAccount\n          v-if=\"state === states.CREATE_ACCOUNT_APPLE\"\n          @signInLinkApple=\"$emit('signInLinkApple')\"\n          @back=\"state = states.CHOICES\"\n          @continue=\"state = states.APPLE_CREDENTIALS\"\n        />\n      </v-expand-transition>\n      <v-expand-transition>\n        <AppleCredentials\n          v-if=\"state === states.APPLE_CREDENTIALS\"\n          @back=\"state = states.CHOICES\"\n          @addedAppleCalendar=\"$emit('addedAppleCalendar')\"\n        />\n      </v-expand-transition>\n    </v-card>\n  </v-dialog>\n</template>\n\n<script>\nimport { isPhone } from \"@/utils\"\nimport { mapActions, mapState } from \"vuex\"\nimport CalendarPermissionsCard from \"./CalendarPermissionsCard\"\nimport CreateAccount from \"./CreateAccount\"\nimport AppleCredentials from \"./AppleCredentials\"\n\nexport default {\n  name: \"MarkAvailabilityDialog\",\n\n  props: {\n    value: { type: Boolean, required: true },\n    initialState: { type: String, default: \"choices\" },\n  },\n\n  components: {\n    CalendarPermissionsCard,\n    CreateAccount,\n    AppleCredentials,\n  },\n\n  data() {\n    return {\n      states: {\n        CHOICES: \"choices\", // present user with choice of automatic or manual\n        GCAL_PERMISSIONS: \"gcal_permissions\", // present to user the gcal permissions we request\n        CREATE_ACCOUNT_APPLE: \"create_account_apple\", // present to user the create account dialog\n        APPLE_CREDENTIALS: \"apple_credentials\", // present to user the apple credentials dialog\n      },\n      state: this.initialState,\n    }\n  },\n\n  computed: {\n    ...mapState([\"authUser\"]),\n    isPhone() {\n      return isPhone(this.$vuetify)\n    },\n  },\n\n  methods: {\n    ...mapActions([\"showInfo\"]),\n    setAvailabilityManually() {\n      this.$emit(\"setAvailabilityManually\")\n    },\n    autofillWithGcal() {\n      this.$posthog?.capture(\"autofill_with_gcal_clicked\")\n      this.state = this.states.GCAL_PERMISSIONS\n    },\n    autofillWithApple() {\n      this.$posthog?.capture(\"autofill_with_apple_clicked\")\n      if (this.authUser) {\n        this.state = this.states.APPLE_CREDENTIALS\n      } else {\n        this.state = this.states.CREATE_ACCOUNT_APPLE\n      }\n    },\n    autofillWithOutlook() {\n      this.$posthog?.capture(\"autofill_with_outlook_clicked\")\n      this.$emit(\"allowOutlookCalendar\")\n    },\n    showChoices() {\n      this.state = this.states.CHOICES\n    },\n  },\n\n  watch: {\n    value() {\n      if (!this.value) setTimeout(() => (this.state = this.states.CHOICES), 100)\n    },\n  },\n}\n</script>\n"],"mappings":"AAkGA,SAAAA,OAAA;AACA,SAAAC,UAAA,EAAAC,QAAA;AACA,OAAAC,uBAAA;AACA,OAAAC,aAAA;AACA,OAAAC,gBAAA;AAEA;EACAC,IAAA;EAEAC,KAAA;IACAC,KAAA;MAAAC,IAAA,EAAAC,OAAA;MAAAC,QAAA;IAAA;IACAC,YAAA;MAAAH,IAAA,EAAAI,MAAA;MAAAC,OAAA;IAAA;EACA;EAEAC,UAAA;IACAZ,uBAAA;IACAC,aAAA;IACAC;EACA;EAEAW,KAAA;IACA;MACAC,MAAA;QACAC,OAAA;QAAA;QACAC,gBAAA;QAAA;QACAC,oBAAA;QAAA;QACAC,iBAAA;MACA;MACAC,KAAA,OAAAV;IACA;EACA;EAEAW,QAAA;IACA,GAAArB,QAAA;IACAF,QAAA;MACA,OAAAA,OAAA,MAAAwB,QAAA;IACA;EACA;EAEAC,OAAA;IACA,GAAAxB,UAAA;IACAyB,wBAAA;MACA,KAAAC,KAAA;IACA;IACAC,iBAAA;MACA,KAAAC,QAAA,EAAAC,OAAA;MACA,KAAAR,KAAA,QAAAL,MAAA,CAAAE,gBAAA;IACA;IACAY,kBAAA;MACA,KAAAF,QAAA,EAAAC,OAAA;MACA,SAAAE,QAAA;QACA,KAAAV,KAAA,QAAAL,MAAA,CAAAI,iBAAA;MACA;QACA,KAAAC,KAAA,QAAAL,MAAA,CAAAG,oBAAA;MACA;IACA;IACAa,oBAAA;MACA,KAAAJ,QAAA,EAAAC,OAAA;MACA,KAAAH,KAAA;IACA;IACAO,YAAA;MACA,KAAAZ,KAAA,QAAAL,MAAA,CAAAC,OAAA;IACA;EACA;EAEAiB,KAAA;IACA3B,MAAA;MACA,UAAAA,KAAA,EAAA4B,UAAA,YAAAd,KAAA,QAAAL,MAAA,CAAAC,OAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}