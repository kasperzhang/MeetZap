{"ast":null,"code":"import { mapState, mapActions } from \"vuex\";\nimport { _delete, patch, isPhone, get } from \"@/utils\";\nimport CalendarAccounts from \"@/components/settings/CalendarAccounts.vue\";\nexport default {\n  name: \"Settings\",\n  metaInfo: {\n    title: \"Settings - Schej\"\n  },\n  components: {\n    CalendarAccounts\n  },\n  data: () => ({\n    dialog: false,\n    deleteDialog: false,\n    deleteValidateEmail: \"\",\n    heading: [\"Permission\", \"Purpose\", \"Requested When\"],\n    content: [[\"View all calendar events\", \"Allows us to display the names/times of your calendar events\", \"User tries to input availability automatically with Google Calendar\"], [\"View all calendars subscribed to\", \"Allows us to display calendar events on all your calendars instead of just your primary calendar\", \"User tries to input availability automatically with Google Calendar\"]],\n    // Profile settings\n    firstName: \"\",\n    lastName: \"\"\n  }),\n  computed: {\n    ...mapState([\"authUser\"]),\n    nameUnsavedChanges() {\n      return this.firstName !== this.authUser.firstName || this.lastName !== this.authUser.lastName;\n    },\n    profileUnsavedChanges() {\n      return this.nameUnsavedChanges;\n    },\n    isPhone() {\n      return isPhone(this.$vuetify);\n    }\n  },\n  methods: {\n    ...mapActions([\"showError\"]),\n    openBillingPortal() {\n      get(`/stripe/billing-portal?customerId=${encodeURIComponent(this.authUser.stripeCustomerId)}&returnUrl=${encodeURIComponent(window.location.href)}`).then(res => {\n        window.location.href = res.url;\n      }).catch(err => {\n        this.showError(\"There was a problem opening the billing portal! Please try again later.\");\n      });\n    },\n    deleteAccount() {\n      _delete(`/user`).then(() => {\n        window.location.reload();\n      }).catch(err => {\n        this.showError(\"There was a problem deleting your account! Please try again later.\");\n      });\n    },\n    resetProfileChanges() {\n      this.firstName = this.authUser.firstName;\n      this.lastName = this.authUser.lastName;\n    },\n    saveName() {\n      patch(`/user/name`, {\n        firstName: this.firstName,\n        lastName: this.lastName\n      }).then(() => {\n        window.location.reload();\n      }).catch(err => {\n        this.showError(\"There was a problem updating your name! Please try again later.\");\n      });\n    }\n  },\n  created() {\n    this.firstName = this.authUser.firstName;\n    this.lastName = this.authUser.lastName;\n  }\n};","map":{"version":3,"names":["mapState","mapActions","_delete","patch","isPhone","get","CalendarAccounts","name","metaInfo","title","components","data","dialog","deleteDialog","deleteValidateEmail","heading","content","firstName","lastName","computed","nameUnsavedChanges","authUser","profileUnsavedChanges","$vuetify","methods","openBillingPortal","encodeURIComponent","stripeCustomerId","window","location","href","then","res","url","catch","err","showError","deleteAccount","reload","resetProfileChanges","saveName","created"],"sources":["src/views/Settings.vue"],"sourcesContent":["<template>\n  <div class=\"tw-mx-auto tw-mb-12 tw-mt-5 tw-max-w-6xl\">\n    <div class=\"tw-flex tw-flex-col tw-gap-16 tw-p-4\">\n      <!-- Name change section -->\n      <div class=\"tw-flex tw-flex-col tw-gap-5\">\n        <div\n          class=\"tw-text-xl tw-font-medium tw-text-dark-green sm:tw-text-2xl\"\n        >\n          Profile\n        </div>\n        <div>\n          <div v-if=\"authUser\" class=\"tw-mb-1 tw-font-medium\">Name</div>\n          <div class=\"tw-flex tw-max-w-lg tw-items-center tw-gap-2\">\n            <v-text-field\n              v-model=\"firstName\"\n              hide-details\n              outlined\n              placeholder=\"First name\"\n              :dense=\"isPhone\"\n            />\n            <v-text-field\n              v-model=\"lastName\"\n              hide-details\n              outlined\n              placeholder=\"Last name\"\n              :dense=\"isPhone\"\n            />\n          </div>\n          <v-expand-transition>\n            <div v-if=\"profileUnsavedChanges\">\n              <div class=\"tw-mt-4\">\n                <v-btn\n                  @click=\"resetProfileChanges\"\n                  color=\"primary\"\n                  outlined\n                  class=\"tw-mr-2\"\n                  >Cancel</v-btn\n                >\n                <v-btn @click=\"saveName\" color=\"primary\">Save changes</v-btn>\n              </div>\n            </div>\n          </v-expand-transition>\n        </div>\n      </div>\n\n      <!-- Billing Section -->\n      <div\n        v-if=\"authUser && authUser.stripeCustomerId\"\n        class=\"tw-flex tw-flex-col tw-gap-5\"\n      >\n        <div\n          class=\"tw-text-xl tw-font-medium tw-text-dark-green sm:tw-text-2xl\"\n        >\n          Billing\n        </div>\n        <div class=\"tw-flex tw-flex-col tw-gap-5 sm:tw-flex-row sm:tw-gap-28\">\n          <div class=\"tw-text-black\">\n            <v-btn @click=\"openBillingPortal\">Manage billing</v-btn>\n          </div>\n        </div>\n      </div>\n\n      <!-- Calendar Access Section -->\n      <div class=\"tw-flex tw-flex-col tw-gap-5\">\n        <div\n          class=\"tw-text-xl tw-font-medium tw-text-dark-green sm:tw-text-2xl\"\n        >\n          Calendar access\n        </div>\n        <div class=\"tw-flex tw-flex-col tw-gap-5 sm:tw-flex-row sm:tw-gap-28\">\n          <div class=\"tw-text-black\">\n            We do not store your calendar data anywhere on our servers, and we\n            only fetch your calendar events for the time frame you specify in\n            order to display your calendar events while you fill out your\n            availability.\n          </div>\n          <v-btn\n            outlined\n            class=\"tw-text-red\"\n            href=\"https://myaccount.google.com/connections?filters=3,4&hl=en\"\n            target=\"_blank\"\n            >Revoke calendar access</v-btn\n          >\n        </div>\n        <CalendarAccounts></CalendarAccounts>\n      </div>\n\n      <!-- Permissions Section -->\n      <div class=\"tw-flex tw-flex-col tw-gap-5\">\n        <div\n          class=\"tw-text-xl tw-font-medium tw-text-dark-green sm:tw-text-2xl\"\n        >\n          Permissions\n        </div>\n        <div\n          class=\"tw-flex tw-flex-col tw-rounded-md tw-border-[1px] tw-border-light-gray-stroke\"\n        >\n          <div\n            class=\"tw-flex tw-w-full tw-flex-row tw-border-b-[1px] tw-border-light-gray-stroke\"\n          >\n            <div\n              v-for=\"(h, i) in heading\"\n              :class=\"`tw-border-r-[${i == heading.length - 1 ? '0' : '1'}px]`\"\n              class=\"tw-w-1/3 tw-border-light-gray-stroke tw-p-4 tw-font-bold\"\n            >\n              {{ h }}\n            </div>\n          </div>\n\n          <div\n            v-for=\"(c, j) in content\"\n            :class=\"`tw-border-b-[${j == content.length - 1 ? '0' : '1'}px]`\"\n            class=\"tw-flex tw-w-full tw-flex-row tw-border-light-gray-stroke\"\n          >\n            <div\n              v-for=\"(text, k) in c\"\n              :class=\"`tw-border-r-[${k == c.length - 1 ? '0' : '1'}px]`\"\n              class=\"tw-w-1/3 tw-border-light-gray-stroke tw-p-4\"\n            >\n              {{ text }}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Question Section -->\n      <div class=\"tw-flex tw-flex-col tw-gap-5\">\n        <div\n          class=\"tw-text-xl tw-font-medium tw-text-dark-green sm:tw-text-2xl\"\n        >\n          Have a question?\n        </div>\n        <div class=\"tw-flex tw-flex-col tw-gap-5 sm:tw-flex-row sm:tw-gap-28\">\n          <div class=\"tw-text-black\">\n            Email us at\n            <a\n              href=\"mailto:schej.team@gmail.com\"\n              class=\"tw-text-black tw-underline\"\n              >schej.team@gmail.com</a\n            >\n            with any questions!\n          </div>\n        </div>\n      </div>\n\n      <!-- Delete Account Section -->\n      <div class=\"tw-mt-28 tw-flex tw-flex-row tw-justify-center\">\n        <div class=\"tw-w-64\">\n          <v-dialog v-model=\"deleteDialog\" width=\"400\" persistent>\n            <template v-slot:activator=\"{ on, attrs }\">\n              <v-btn outlined class=\"tw-text-red\" block v-bind=\"attrs\" v-on=\"on\"\n                >Delete account</v-btn\n              >\n            </template>\n            <v-card>\n              <v-card-title>Are you sure?</v-card-title>\n              <v-card-text class=\"tw-text-sm tw-text-dark-gray\"\n                >Are you sure you want to delete your account? All your account\n                data will be lost.</v-card-text\n              >\n              <div class=\"tw-mx-6\">\n                <div class=\"tw-text-sm tw-text-dark-gray\">\n                  Type your email in the box below to confirm:\n                </div>\n                <v-text-field\n                  v-model=\"deleteValidateEmail\"\n                  autofocus\n                  class=\"tw-flex-initial tw-text-white\"\n                  :placeholder=\"authUser.email\"\n                />\n              </div>\n              <v-card-actions>\n                <v-spacer />\n                <v-btn text @click=\"deleteDialog = false\">Cancel</v-btn>\n                <v-btn\n                  text\n                  color=\"error\"\n                  @click=\"deleteAccount()\"\n                  :disabled=\"authUser.email != deleteValidateEmail\"\n                  >Delete</v-btn\n                >\n              </v-card-actions>\n            </v-card>\n          </v-dialog>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapState, mapActions } from \"vuex\"\nimport { _delete, patch, isPhone, get } from \"@/utils\"\nimport CalendarAccounts from \"@/components/settings/CalendarAccounts.vue\"\n\nexport default {\n  name: \"Settings\",\n\n  metaInfo: {\n    title: \"Settings - Schej\",\n  },\n\n  components: { CalendarAccounts },\n\n  data: () => ({\n    dialog: false,\n    deleteDialog: false,\n    deleteValidateEmail: \"\",\n    heading: [\"Permission\", \"Purpose\", \"Requested When\"],\n    content: [\n      [\n        \"View all calendar events\",\n        \"Allows us to display the names/times of your calendar events\",\n        \"User tries to input availability automatically with Google Calendar\",\n      ],\n      [\n        \"View all calendars subscribed to\",\n        \"Allows us to display calendar events on all your calendars instead of just your primary calendar\",\n        \"User tries to input availability automatically with Google Calendar\",\n      ],\n    ],\n\n    // Profile settings\n    firstName: \"\",\n    lastName: \"\",\n  }),\n\n  computed: {\n    ...mapState([\"authUser\"]),\n    nameUnsavedChanges() {\n      return (\n        this.firstName !== this.authUser.firstName ||\n        this.lastName !== this.authUser.lastName\n      )\n    },\n    profileUnsavedChanges() {\n      return this.nameUnsavedChanges\n    },\n    isPhone() {\n      return isPhone(this.$vuetify)\n    },\n  },\n\n  methods: {\n    ...mapActions([\"showError\"]),\n    openBillingPortal() {\n      get(\n        `/stripe/billing-portal?customerId=${encodeURIComponent(\n          this.authUser.stripeCustomerId\n        )}&returnUrl=${encodeURIComponent(window.location.href)}`\n      )\n        .then((res) => {\n          window.location.href = res.url\n        })\n        .catch((err) => {\n          this.showError(\n            \"There was a problem opening the billing portal! Please try again later.\"\n          )\n        })\n    },\n    deleteAccount() {\n      _delete(`/user`)\n        .then(() => {\n          window.location.reload()\n        })\n        .catch((err) => {\n          this.showError(\n            \"There was a problem deleting your account! Please try again later.\"\n          )\n        })\n    },\n    resetProfileChanges() {\n      this.firstName = this.authUser.firstName\n      this.lastName = this.authUser.lastName\n    },\n    saveName() {\n      patch(`/user/name`, {\n        firstName: this.firstName,\n        lastName: this.lastName,\n      })\n        .then(() => {\n          window.location.reload()\n        })\n        .catch((err) => {\n          this.showError(\n            \"There was a problem updating your name! Please try again later.\"\n          )\n        })\n    },\n  },\n\n  created() {\n    this.firstName = this.authUser.firstName\n    this.lastName = this.authUser.lastName\n  },\n}\n</script>\n"],"mappings":"AA+LA,SAAAA,QAAA,EAAAC,UAAA;AACA,SAAAC,OAAA,EAAAC,KAAA,EAAAC,OAAA,EAAAC,GAAA;AACA,OAAAC,gBAAA;AAEA;EACAC,IAAA;EAEAC,QAAA;IACAC,KAAA;EACA;EAEAC,UAAA;IAAAJ;EAAA;EAEAK,IAAA,EAAAA,CAAA;IACAC,MAAA;IACAC,YAAA;IACAC,mBAAA;IACAC,OAAA;IACAC,OAAA,GACA,CACA,4BACA,gEACA,sEACA,EACA,CACA,oCACA,oGACA,sEACA,CACA;IAEA;IACAC,SAAA;IACAC,QAAA;EACA;EAEAC,QAAA;IACA,GAAAnB,QAAA;IACAoB,mBAAA;MACA,OACA,KAAAH,SAAA,UAAAI,QAAA,CAAAJ,SAAA,IACA,KAAAC,QAAA,UAAAG,QAAA,CAAAH,QAAA;IAEA;IACAI,sBAAA;MACA,YAAAF,kBAAA;IACA;IACAhB,QAAA;MACA,OAAAA,OAAA,MAAAmB,QAAA;IACA;EACA;EAEAC,OAAA;IACA,GAAAvB,UAAA;IACAwB,kBAAA;MACApB,GAAA,CACA,qCAAAqB,kBAAA,CACA,KAAAL,QAAA,CAAAM,gBACA,eAAAD,kBAAA,CAAAE,MAAA,CAAAC,QAAA,CAAAC,IAAA,GACA,EACAC,IAAA,CAAAC,GAAA;QACAJ,MAAA,CAAAC,QAAA,CAAAC,IAAA,GAAAE,GAAA,CAAAC,GAAA;MACA,GACAC,KAAA,CAAAC,GAAA;QACA,KAAAC,SAAA,CACA,yEACA;MACA;IACA;IACAC,cAAA;MACAnC,OAAA,UACA6B,IAAA;QACAH,MAAA,CAAAC,QAAA,CAAAS,MAAA;MACA,GACAJ,KAAA,CAAAC,GAAA;QACA,KAAAC,SAAA,CACA,oEACA;MACA;IACA;IACAG,oBAAA;MACA,KAAAtB,SAAA,QAAAI,QAAA,CAAAJ,SAAA;MACA,KAAAC,QAAA,QAAAG,QAAA,CAAAH,QAAA;IACA;IACAsB,SAAA;MACArC,KAAA;QACAc,SAAA,OAAAA,SAAA;QACAC,QAAA,OAAAA;MACA,GACAa,IAAA;QACAH,MAAA,CAAAC,QAAA,CAAAS,MAAA;MACA,GACAJ,KAAA,CAAAC,GAAA;QACA,KAAAC,SAAA,CACA,iEACA;MACA;IACA;EACA;EAEAK,QAAA;IACA,KAAAxB,SAAA,QAAAI,QAAA,CAAAJ,SAAA;IACA,KAAAC,QAAA,QAAAG,QAAA,CAAAH,QAAA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}