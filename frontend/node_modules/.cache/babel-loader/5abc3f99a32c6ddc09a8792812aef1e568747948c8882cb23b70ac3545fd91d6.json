{"ast":null,"code":"import { isPhone, validateEmail } from \"@/utils\";\nexport default {\n  name: \"GuestDialog\",\n  emits: [\"input\", \"submit\"],\n  props: {\n    value: {\n      type: Boolean,\n      required: true\n    },\n    event: {\n      type: Object,\n      required: true\n    },\n    respondents: {\n      type: Array,\n      required: true\n    }\n  },\n  data() {\n    return {\n      formValid: false,\n      name: \"\",\n      email: \"\",\n      nameRules: [],\n      emailRules: []\n    };\n  },\n  computed: {\n    isPhone() {\n      return isPhone(this.$vuetify);\n    }\n  },\n  methods: {\n    submit() {\n      // Set rules only on submit\n      this.nameRules = [name => !!name || \"请输入您的昵称\", name => !this.respondents.includes(name) || \"Name already taken\"];\n      this.emailRules = [email => !!email || \"请输入您的邮箱\", email => !!validateEmail(email) || \"Invalid email\"];\n      this.$nextTick(() => {\n        if (!this.$refs.form.validate()) return;\n        this.$emit(\"submit\", {\n          name: this.name,\n          email: this.email\n        });\n      });\n    }\n  },\n  watch: {\n    value() {\n      if (this.value) {\n        this.name = \"\";\n        this.email = \"\";\n        this.nameRules = [];\n        this.emailRules = [];\n        this.$refs.form?.resetValidation();\n      }\n    },\n    name() {\n      // Default rules before submitting\n      this.nameRules = [name => !this.respondents.includes(name) || \"Name already taken\"];\n    },\n    email() {\n      // Default rules before submitting\n      this.emailRules = [];\n    }\n  }\n};","map":{"version":3,"names":["isPhone","validateEmail","name","emits","props","value","type","Boolean","required","event","Object","respondents","Array","data","formValid","email","nameRules","emailRules","computed","$vuetify","methods","submit","includes","$nextTick","$refs","form","validate","$emit","watch","resetValidation"],"sources":["src/components/GuestDialog.vue"],"sourcesContent":["<template>\n  <v-dialog\n    :value=\"value\"\n    @input=\"(e) => $emit('input', e)\"\n    width=\"400\"\n    content-class=\"tw-m-0\"\n  >\n    <v-card>\n      <v-card-title class=\"tw-flex\">\n        <div>参与者信息ß</div>\n        <v-spacer />\n        <v-btn icon @click=\"$emit('input', false)\">\n          <v-icon>mdi-close</v-icon>\n        </v-btn>\n      </v-card-title>\n      <v-card-text>\n        <v-form\n          ref=\"form\"\n          v-model=\"formValid\"\n          lazy-validation\n          class=\"tw-flex tw-flex-col tw-gap-y-4\"\n          onsubmit=\"return false;\"\n        >\n          <v-text-field\n            v-model=\"name\"\n            @keyup.enter=\"submit\"\n            :rules=\"nameRules\"\n            placeholder=\"请输入您的昵称...\"\n            autofocus\n            hide-details=\"auto\"\n            autocomplete=\"off\"\n            solo\n          ></v-text-field>\n          <v-text-field\n            v-if=\"event.collectEmails\"\n            v-model=\"email\"\n            @keyup.enter=\"submit\"\n            :rules=\"emailRules\"\n            placeholder=\"请输入您的邮箱...\"\n            hint=\"活动创建者正在收集邮箱。我们绝不会向任何人分享您的邮箱或联系您。\"\n            persistent-hint\n            solo\n          ></v-text-field>\n          <div class=\"tw-flex\">\n            <v-spacer />\n            <v-btn\n              @click=\"submit\"\n              class=\"tw-bg-green\"\n              :dark=\"formValid\"\n              :disabled=\"!formValid\"\n            >\n              继续\n            </v-btn>\n          </div>\n        </v-form>\n      </v-card-text>\n    </v-card>\n  </v-dialog>\n</template>\n\n<script>\nimport { isPhone, validateEmail } from \"@/utils\"\n\nexport default {\n  name: \"GuestDialog\",\n\n  emits: [\"input\", \"submit\"],\n\n  props: {\n    value: { type: Boolean, required: true },\n    event: { type: Object, required: true },\n    respondents: { type: Array, required: true },\n  },\n\n  data() {\n    return {\n      formValid: false,\n      name: \"\",\n      email: \"\",\n      nameRules: [],\n      emailRules: [],\n    }\n  },\n\n  computed: {\n    isPhone() {\n      return isPhone(this.$vuetify)\n    },\n  },\n\n  methods: {\n    submit() {\n      // Set rules only on submit\n      this.nameRules = [\n        (name) => !!name || \"请输入您的昵称\",\n        (name) => !this.respondents.includes(name) || \"Name already taken\",\n      ]\n      this.emailRules = [\n        (email) => !!email || \"请输入您的邮箱\",\n        (email) => !!validateEmail(email) || \"Invalid email\",\n      ]\n\n      this.$nextTick(() => {\n        if (!this.$refs.form.validate()) return\n\n        this.$emit(\"submit\", { name: this.name, email: this.email })\n      })\n    },\n  },\n\n  watch: {\n    value() {\n      if (this.value) {\n        this.name = \"\"\n        this.email = \"\"\n        this.nameRules = []\n        this.emailRules = []\n\n        this.$refs.form?.resetValidation()\n      }\n    },\n    name() {\n      // Default rules before submitting\n      this.nameRules = [\n        (name) => !this.respondents.includes(name) || \"Name already taken\",\n      ]\n    },\n    email() {\n      // Default rules before submitting\n      this.emailRules = []\n    },\n  },\n}\n</script>\n"],"mappings":"AA6DA,SAAAA,OAAA,EAAAC,aAAA;AAEA;EACAC,IAAA;EAEAC,KAAA;EAEAC,KAAA;IACAC,KAAA;MAAAC,IAAA,EAAAC,OAAA;MAAAC,QAAA;IAAA;IACAC,KAAA;MAAAH,IAAA,EAAAI,MAAA;MAAAF,QAAA;IAAA;IACAG,WAAA;MAAAL,IAAA,EAAAM,KAAA;MAAAJ,QAAA;IAAA;EACA;EAEAK,KAAA;IACA;MACAC,SAAA;MACAZ,IAAA;MACAa,KAAA;MACAC,SAAA;MACAC,UAAA;IACA;EACA;EAEAC,QAAA;IACAlB,QAAA;MACA,OAAAA,OAAA,MAAAmB,QAAA;IACA;EACA;EAEAC,OAAA;IACAC,OAAA;MACA;MACA,KAAAL,SAAA,IACAd,IAAA,MAAAA,IAAA,eACAA,IAAA,UAAAS,WAAA,CAAAW,QAAA,CAAApB,IAAA,0BACA;MACA,KAAAe,UAAA,IACAF,KAAA,MAAAA,KAAA,eACAA,KAAA,MAAAd,aAAA,CAAAc,KAAA,qBACA;MAEA,KAAAQ,SAAA;QACA,UAAAC,KAAA,CAAAC,IAAA,CAAAC,QAAA;QAEA,KAAAC,KAAA;UAAAzB,IAAA,OAAAA,IAAA;UAAAa,KAAA,OAAAA;QAAA;MACA;IACA;EACA;EAEAa,KAAA;IACAvB,MAAA;MACA,SAAAA,KAAA;QACA,KAAAH,IAAA;QACA,KAAAa,KAAA;QACA,KAAAC,SAAA;QACA,KAAAC,UAAA;QAEA,KAAAO,KAAA,CAAAC,IAAA,EAAAI,eAAA;MACA;IACA;IACA3B,KAAA;MACA;MACA,KAAAc,SAAA,IACAd,IAAA,UAAAS,WAAA,CAAAW,QAAA,CAAApB,IAAA,0BACA;IACA;IACAa,MAAA;MACA;MACA,KAAAE,UAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}